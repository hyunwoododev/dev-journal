# AWS MSK와 Confluent Kafka의 비교 및 Confluent Kafka 선택 이유

## 개요

이 문서는 **AWS Managed Streaming for Apache Kafka (MSK)**와 **Confluent Kafka**의 차이점을 비교하고, 프로젝트 요구 사항에 따라 **Confluent Kafka**를 선택하게 된 배경을 설명합니다.

## 1. 프로젝트 배경

프로젝트는 실시간 데이터 파이프라인을 구축하기 위해 다음과 같은 아키텍처를 계획하고 있습니다:

- **단말기**에서 **MQTT 프로토콜**을 사용하여 **AWS IoT Core**로 데이터를 전송
- **AWS IoT Core**가 데이터를 **Kafka**로 전달
- **Lambda 함수**가 Kafka로부터 데이터를 소비하여 필요한 서버로 데이터를 전달

처음에는 AWS IoT Core와의 자연스러운 통합을 위해 **AWS MSK**를 고려했지만, **성능 이슈**와 **제약 사항**을 확인한 후 **Confluent Kafka**의 도입 가능성을 검토하게 되었습니다.

## 2. AWS MSK와 Confluent Kafka의 비교

### 2.1 서비스 제공 형태 및 통합성

- **AWS MSK**
  - **AWS에서 제공하는 완전 관리형 Kafka 서비스**입니다.
  - **AWS 생태계와의 원활한 통합**이 가능하여 AWS의 IAM, VPC, Lambda 등과의 호환성이 뛰어납니다.
  - AWS의 보안, 네트워크 구성 등을 활용하여 관리할 수 있습니다.

- **Confluent Kafka**
  - **Confluent Inc.**에서 제공하는 **Kafka 중심의 데이터 스트리밍 플랫폼**입니다.
  - 자체 관리형 소프트웨어와 **Confluent Cloud**라는 완전 관리형 클라우드 서비스를 제공합니다.
  - AWS 외에도 **멀티 클라우드 및 온프레미스 환경**에서 유연하게 사용할 수 있습니다.

### 2.2 기능 및 성능

- **AWS MSK**
  - **Apache Kafka의 기본 기능**을 제공합니다.
  - AWS 서비스와의 통합이 용이하지만, **고급 기능이 기본적으로 제공되지 않습니다**.
  - 일부 사용자들이 보고한 **성능 이슈**가 있으며, 최신 Kafka 버전 지원이 다소 지연될 수 있습니다.

- **Confluent Kafka**
  - **우수한 성능과 낮은 지연 시간**을 제공합니다.
  - **Schema Registry**, **ksqlDB**, **Kafka Connect** 등 다양한 **고급 기능**을 통해 스트리밍 데이터 관리와 처리를 강화합니다.
  - **최신 Kafka 버전**을 빠르게 지원하여 새로운 기능과 성능 개선 사항을 신속히 활용할 수 있습니다.

### 2.3 운영 및 관리

- **AWS MSK**
  - AWS가 관리형 서비스로 운영을 간소화하며, 기본적인 운영 및 모니터링을 CloudWatch로 지원합니다.
  - 그러나 Kafka 특화된 모니터링 및 관리 도구는 제한적입니다.

- **Confluent Kafka**
  - **Confluent Control Center**를 통해 **상세한 모니터링과 운영 관리 기능**을 제공합니다.
  - 전문적인 기술 지원이 제공되며, Kafka 특화된 모니터링 지표와 실시간 경고 설정이 가능합니다.

### 2.4 비용

- **AWS MSK**
  - 사용 리소스에 따라 과금되며, 추가 라이선스 비용이 없습니다.
  - 초기 비용이 낮지만, 대규모로 확장할수록 비용이 증가할 수 있습니다.

- **Confluent Kafka**
  - 부가 기능 사용에 따른 **라이선스 비용**이 발생할 수 있습니다.
  - 고급 기능을 활용해 운영 효율성을 높일 수 있어, 장기적으로 총소유비용(TCO)을 절감할 수 있습니다.

## 3. Confluent Kafka의 주요 고급 기능

Confluent Kafka는 Apache Kafka의 기본 기능을 확장하는 고급 기능을 제공합니다. 프로젝트 요구 사항을 충족시키기 위해 중요한 Confluent Kafka의 고급 기능은 다음과 같습니다:

### 3.1 Schema Registry

- 데이터의 스키마를 중앙에서 관리하여 **프로듀서와 컨슈머 간 데이터 일관성**을 유지할 수 있습니다.
- 스키마 버전 관리로 변경 시 **호환성 문제를 방지**하고, 데이터 품질을 보장합니다.

### 3.2 Kafka Connect

- **프리빌트 커넥터**를 사용하여 코드 작성 없이 다양한 데이터 소스 및 싱크와 연동할 수 있습니다.
- 데이터 파이프라인을 구축하고 유지보수하는 작업을 간소화하여 개발 효율성을 높입니다.

### 3.3 ksqlDB

- **SQL 기반 쿼리**를 사용해 Kafka 스트림 데이터를 실시간으로 처리하고 분석할 수 있습니다.
- 복잡한 스트림 처리 로직을 쉽게 구현하여 실시간 데이터 분석과 응답을 지원합니다.

### 3.4 Control Center

- Kafka 클러스터의 **상태 모니터링 및 관리 도구**로, 직관적인 대시보드를 제공합니다.
- 토픽 관리, 파티션 상태 모니터링, 실시간 알림 설정 등을 통해 운영 효율성을 증대합니다.

## 4. Confluent Kafka 선택 이유

위의 비교와 주요 기능을 고려했을 때, 저희는 Confluent Kafka가 프로젝트 요구 사항에 적합하다고 판단했습니다. 다음은 Confluent Kafka를 선택한 구체적인 이유입니다.

### 4.1 성능 요구 사항 충족

Confluent Kafka는 **낮은 지연 시간**과 **높은 처리량**을 제공하여 실시간 데이터 처리와 고성능이 필요한 우리의 시스템에 적합합니다.

### 4.2 고급 기능 활용

- **Schema Registry**를 통해 데이터 구조 변경 시 **호환성 문제를 방지**할 수 있습니다.
- **Kafka Connect**를 활용해 다양한 시스템과 **추가 개발 없이** 손쉽게 연동할 수 있습니다.
- **ksqlDB**를 사용하여 **SQL 기반의 실시간 데이터 처리**를 구현할 수 있습니다.

### 4.3 운영 효율성 증대

Confluent Control Center를 통해 **클러스터 상태를 직관적으로 모니터링**하고 **문제 발생 시 신속하게 대응**할 수 있습니다. 또한, 전문적인 기술 지원이 제공되어 운영 부담을 줄일 수 있습니다.

### 4.4 장기적인 확장성

향후 멀티 클라우드 환경이나 온프레미스 시스템과의 통합을 고려하고 있습니다. Confluent Kafka는 다양한 환경에서 유연하게 운영될 수 있어 **미래의 확장성과 시스템 유연성을 보장**합니다.

## 5. 결론

위와 같은 이유로 **Confluent Kafka**를 선택하게 되었습니다. AWS MSK는 AWS 서비스와의 통합이 용이하고 초기 비용이 낮다는 장점이 있지만, Confluent Kafka는 **성능, 고급 기능, 운영 효율성, 장기적인 확장성** 측면에서 우리의 프로젝트 요구 사항에 더 부합한다고 판단되었습니다.

Confluent Kafka의 주요 고급 기능을 활용하여 시스템의 **신뢰성**과 **확장성**을 높이고, **운영 효율성**을 강화하여 프로젝트 목표를 효과적으로 달성할 수 있을 것으로 기대됩니다.

--- 