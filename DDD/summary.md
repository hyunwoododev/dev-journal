
# 도메인 주도 설계(DDD)와 이벤트 스토밍 중심의 마이크로서비스 설계

---

## 1. 도메인 주도 설계(DDD)의 개념

### 도메인의 중요성
- DDD는 비즈니스의 실제 운영 방식을 기술적 아키텍처에 반영하는 설계 방식입니다.
- IT와 비즈니스 팀 간의 의사소통을 원활히 하고, 실질적인 요구사항을 시스템에 구현할 수 있습니다.

### 공통 언어(Ubiquitous Language)
- 비즈니스 전문가와 IT 개발자 간의 공통 언어를 정의해 협업의 효율성을 높입니다.
- 예를 들어, 비즈니스 이벤트(사용자 생성, 주문 완료 등)를 양측이 동일하게 이해할 수 있도록 명확히 정의합니다.

---

## 2. 이벤트 스토밍 (Event Storming)

### 정의와 목적
- 이벤트 스토밍은 비즈니스 이벤트를 시간 순서로 나열해 시스템의 흐름을 시각적으로 표현하는 작업입니다.
- 주요 목적은 도메인의 복잡성을 단순화하고, 비즈니스 요구사항과 기술 설계 간의 간극을 줄이는 것입니다.

### 진행 방식
1. **시각적 접근**: 큰 벽이나 보드에 다양한 색상의 스티커를 사용해 시스템 이벤트를 정리합니다.
2. **스티커의 역할**:
   - 주황색: 이벤트 (예: "사용자 생성됨").
   - 파란색: 커맨드(명령, 예: "사용자 생성 요청").
   - 노란색: 엔티티 또는 객체 (예: "사용자", "계좌").
   - 빨간색: 외부 시스템(예: SMTP 서버, 외부 API).
3. **진행 과정**:
   - 왼쪽에서 오른쪽으로 시간 순서대로 이벤트를 나열.
   - 비즈니스와 기술 팀이 함께 참여하여 빠진 이벤트를 추가하고 수정.

### 주요 특징
- **반복 가능**: 설계 과정에서 언제든지 변경 및 확장이 가능합니다.
- **협업 도구**: 모든 팀원이 동일한 흐름을 이해하고, 커뮤니케이션 비용을 줄이는 데 효과적입니다.

### 결과물
- **바운디드 컨텍스트(Bounded Context)**:
  - 특정 비즈니스 도메인을 기준으로 시스템의 경계를 정의.
- **마이크로서비스 설계 기초**:
  - 그룹핑한 결과는 향후 마이크로서비스로 분리할 수 있는 기반이 됩니다.

---

## 3. 이벤트 스토밍의 결과물과 그룹핑

### 그룹핑 기준
1. **데이터 소유권(Data Ownership)**:
   - 데이터의 주인은 누구이며, 어떤 팀이 책임질지 정의.
2. **배포와 라이프사이클 독립성**:
   - 각 서비스가 독립적으로 배포 및 업데이트 가능해야 함.
3. **확장성(Scalability)**:
   - 서비스가 독립적으로 확장 가능해야 함.

### 예시
- 사용자 생성 이벤트와 관련된 이벤트(로그인, 사용자 정보 업데이트)는 "사용자" 도메인에 그룹화.
- 계좌 생성, 검증, 거래와 관련된 이벤트는 "계좌" 도메인에 그룹화.

---

## 4. 보리스 다이어그램(Borist Diagram)

### 정의
- 서비스 간의 관계와 통신 방식을 정의한 다이어그램.
- 동기식(Synchronous)과 비동기식(Asynchronous) 요청을 구분하여 설계.

### 진행 방식
1. **서비스 식별**:
   - 사용자 서비스, 계좌 서비스, 주문 서비스, 포트폴리오 서비스 등 도메인을 기준으로 서비스 식별.
2. **서비스 간 통신 정의**:
   - 포트폴리오 서비스가 사용자 정보, 계좌 정보, 거래 이력 데이터를 요청.
   - 주문 서비스는 외부 검증 시스템과 주식 시장 시스템과 통신.
   - 예: 포트폴리오와 주문 간 통신은 비동기 처리.

### 활용 사례
- 보리스 다이어그램은 서비스 간의 의존성을 명확히 정의하고, 설계 변경이 필요할 경우 유연하게 대응할 수 있습니다.

---

## 5. 서비스 설계 스펙

### 세부 정의 항목
1. **API 정의**:
   - 각 서비스가 제공하는 API 목록(예: 사용자 생성, 계좌 조회, 매수 요청).
2. **데이터 구조**:
   - 각 서비스에서 사용하는 데이터 모델 정의.
3. **유저 스토리**:
   - 사용자 관점에서 서비스의 기능 정의.
   - 예: "사용자는 주식을 검색하고 매수 요청을 한다."
4. **리스크 관리**:
   - 외부 시스템 장애 시 대응 방안 포함.

---

## 6. DDD와 이벤트 스토밍 도입의 효과

### 협업 강화
- 모든 팀원이 동일한 이해를 바탕으로 설계에 참여해 개발 속도를 높입니다.

### 변화 대응력
- 스티커를 기반으로 한 설계 방식은 반복적이고 유연하여, 변화에 빠르게 적응할 수 있습니다.

### 효율성 증대
- 마이크로서비스 설계로 결합도를 낮추고, 독립적인 서비스 업데이트 및 확장이 가능.

---

## 7. 적용 도구와 사례

### 도구 활용
- 물리적 스티커 외에도 Miro, Lucidchart 등 디지털 도구를 활용해 설계 자산화를 진행.

### 적용 사례
- 기존 모놀리식 애플리케이션을 마이크로서비스로 전환하거나, 새로운 클라우드 네이티브 애플리케이션 설계에 활용.

### 교육과 워크샵
- 3~4주 간의 집중적인 교육 및 실습을 통해 팀의 역량 강화.
- 반복적인 설계 과정을 통해 완성도를 높이고 실질적인 기술 구현으로 연결.

---

## 결론
도메인 주도 설계(DDD)와 이벤트 스토밍은 복잡한 비즈니스 요구를 단순화하고, 기술적 구현과 비즈니스 전략 간의 간극을 줄이는 데 효과적입니다. 이를 통해 팀의 협업 효율성을 높이고, 변화에 신속히 대응할 수 있는 유연한 설계를 구현할 수 있습니다.
